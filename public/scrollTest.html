<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Scroll</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="lib/bootstrap-3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="lib/bootstrap-slider-6.0.17/css/bootstrap-slider.min.css">
  <link rel="stylesheet" href="lib/font-awesome-4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/tsplot.css">
  <link rel="stylesheet" href="css/otsvis.css">
  <script src="lib/jquery/jquery-2.2.1.min.js" charset="utf-8"></script>
  <script src="lib/bootstrap-3.3.6/js/bootstrap.min.js" charset="utf-8"></script>
  <script src="lib/bootstrap-slider-6.0.17/bootstrap-slider.min.js" charset="utf-8"></script>
  <script src="lib/d3-3.5.16/d3.min.js" charset="utf-8"></script>
</head>
<body>
<div id="maincontainer" class="container-fluid">
	<div class="row" id="rowNavBar">
		<div class="col-lg-12">
			<ul class="nav nav-tabs" style="margin: 5px 0px 15px 0px;">
				<li class="active"><a href="#">Manage Time Series</a></li>
				<li><a href="#">Time Series Exploration</a></li>
				<li><a href="#">Time Series Analysis</a></li>
				<li><a href="#">Time Series ML Analysis</a></li>
			</ul>
		</div>
	</div>

	<div id="rowSettingsAnchor"></div>
	<div class="row" id="rowSettings">
		<div class="col-lg-7">
			<div id="settingsPanel" class="panel panel-default">
				<div class="panel-heading" id="settingsPanelHeader">Filters and Settings</div>
				<div class="panel-body" id="settingsPanelBody">
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
				</div>
			</div>
		</div>
		<div class="col-lg-5">
			<div id="mapPanel" class="panel panel-default">
				<div class="panel-heading" id="mapPanelHeader">Map</div>
				<div class="panel-body" id="mapPanelBody">
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
					<p>test</p>
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript">
	var settingsIsSticky = false;
	var settingsIsCollapsed = false;
	var settingsCollapseTime = 200;

	function moveSettingsRow() {
		var scrollTop = $(window).scrollTop();
		var anchor = $("#rowSettingsAnchor");
		var anchorOffset = anchor.offset().top;
		//console.log("scrollTop: "+st);
		//console.log("rowSettingsAnchor offset: "+ot);
		if(scrollTop > anchorOffset && !settingsIsSticky) {
			var panelHeaderHeight = $("#settingsPanelHeader").outerHeight();
			$("#rowSettings").css({
				position: "fixed",
				"z-index": "1000",
				width: "100%",
				top: "-3px"
			})
			$("#settingsPanel,#mapPanel").prop("class", "panel panel-primary");
			anchor.css({
				"margin-bottom": (2*panelHeaderHeight)+"px"
			});
			settingsIsSticky = true;
			if(!settingsIsCollapsed) {
				$("#settingsPanelBody,#mapPanelBody").stop().slideUp(settingsCollapseTime);
				settingsIsCollapsed = true;
			}
		}
		else if(scrollTop < anchorOffset && settingsIsSticky) {
			$("#rowSettings").css({
				position: "relative",
				"z-index": "",
				width: "",
				top: ""
			});
			$("#settingsPanel,#mapPanel").prop("class", "panel panel-default");
			anchor.css({
				"margin-bottom": ""
			});
			settingsIsSticky = false;
			if(settingsIsCollapsed) {
				$("#settingsPanelBody,#mapPanelBody").stop().slideDown(settingsCollapseTime);
				settingsIsCollapsed = false;
			}
		}
	}
	$(document).ready(function() {
		$("#settingsPanelHeader,#mapPanelHeader").click(function() {
			settingsIsCollapsed = !settingsIsCollapsed;
			$("#settingsPanelBody,#mapPanelBody").stop().slideToggle(settingsCollapseTime);
		});
		$("#settingsPanel,#mapPanel").hover(function() {
			if(settingsIsSticky && settingsIsCollapsed) {
				settingsIsCollapsed = false;
				$("#settingsPanelBody,#mapPanelBody").stop().slideDown(settingsCollapseTime);
			}
		}, function() {
			if(settingsIsSticky && !settingsIsCollapsed) {
				settingsIsCollapsed = true;
				$("#settingsPanelBody,#mapPanelBody").stop().slideUp(settingsCollapseTime);
			}
		});
		//$(window).scroll(function(event) {
		//	console.log($("#rowSettingsAnchor")[0].getBoundingClientRect().top);
		//});
		$(window).scroll(moveSettingsRow);
	});
	</script>

	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-default">
				<div class="panel-heading">Content 1</div>
				<div class="panel-body">
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-default">
				<div class="panel-heading">Content 2</div>
				<div class="panel-body">
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-lg-12">
			<div class="panel panel-default">
				<div class="panel-heading">Content 3</div>
				<div class="panel-body">
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
					<p>content</p>
				</div>
			</div>
		</div>
	</div>
</div>
</body>
</html>
